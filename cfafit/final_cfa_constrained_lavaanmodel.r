#!/usr/bin/Rscript

install.packages("lavaan.tar.gz",repos=NULL,type="source")
install.packages("itertools")
install.packages("Matrix")
install.packages("DPQ")

library(lavaan)
library(Matrix)
library(DPQ)

options(warn=1)

training = readRDS("imp1.Rds")

full <- scan("full.txt", what="", sep="\n")
sample <- scan("test_withdraw_outliers.txt", what="", sep="\n")
indices = sapply(full, function(x) x %in% sample)

training = training[indices,]

model = "f1 =~ 0.209966*X1200 + 0.258681*X1920 + 0.253758*X1930 + 0.209224*X1940 + 0.219986*X1950 + 0.229905*X1960 + 0.236317*X1970 + 0.292787*X1980 + 0.269889*X1990 + 0.216231*X2000 + 0.097861*X20002_1286 + 0.228218*X2010 + 0.1303*X2020 + 0.268959*X2030 + 0.25536*X20421 + 0.434138*X20425 + 0.197846*X20441 + 0.14638*X20446 + 0.394492*X20458 + 0.267426*X20459 + -0.262547*X20460 + 0.219373*X20479 + 0.124476*X20485 + 0.272809*X20487 + -0.086088*X20489 + 0.362609*X20495 + 0.409012*X20497 + 0.408866*X20498 + 0.123938*X20499 + 0.213022*X2050 + 0.1483*X20500 + 0.25678*X20501 + 0.258246*X20502 + 0.64205*X20505 + 0.760045*X20506 + 0.568408*X20507 + 0.558655*X20508 + 0.825191*X20509 + 0.646104*X20510 + 0.441395*X20511 + 0.693177*X20512 + 0.498087*X20513 + 0.61493*X20514 + 0.757762*X20515 + 0.809555*X20516 + 0.446785*X20517 + 0.724543*X20518 + 0.494625*X20519 + 0.800287*X20520 + 0.236115*X20521 + 0.399181*X20544_1 + 0.106055*X20544_11 + 0.25826*X20544_15 + 0.302079*X20544_6 + 0.185369*X2060 + 0.316629*X2070 + 0.249737*X2080 + 0.173913*X2178 + 0.142205*X4526 + 0.158794*X4548
f10 =~ 0.207737*X1050 + 0.405497*X1070 + -0.145786*X1080 + -0.138702*X1299 + -0.116301*X1309 + -0.265387*X1319 + 0.113137*X1349 + 0.171118*X1359 + -0.247964*X1408 + -0.11886*X1428_1 + 0.345458*X1448_1 + 0.242785*X1468_2 + -0.430723*X1468_4 + 0.392661*X1508_2 + -0.499911*X1508_3 + 0.236597*X1558 + -0.21482*X1568 + -0.148672*X1578 + 0.164281*X1588 + -0.154961*X1737 + 0.1543*X1787 + -0.365782*X20016 + -0.122209*X20077 + -0.30076*X20128 + -0.251*X20414 + -0.274345*X20453 + -0.238929*X20491 + -0.161537*X20522 + -0.286019*X20525 + 0.21826*X21001 + -0.172141*X2139 + -0.21775*X22501 + -0.132279*X22599 + -0.252855*X22607_0 + 0.152443*X22607_1 + -0.178342*X22608_0 + -0.235305*X22611_0 + -0.312825*X22615_0 + -0.495703*X22617_2311 + -0.323695*X22617_2312 + -0.362304*X22617_2313 + -0.542981*X22617_2314 + -0.343146*X22617_2315 + -0.285309*X22617_2319 + -0.405098*X22617_2329 + 0.296125*X22617_4150 + 0.265606*X22617_7111 + 0.348009*X22617_9219 + 0.128941*X22704 + -0.125908*X24016 + 0.117512*X30530 + 0.091003*X4290 + -0.089377*X4570 + -0.126679*X50 + 0.137655*X5057 + 0.142384*X5084 + 0.171752*X5085 + -0.832259*X6138_1 + -0.494877*X6138_2 + -0.243027*X6138_3 + 0.413532*X6138_4 + 0.30679*X6138_5 + -0.357588*X6138_6 + -0.228436*X6139_3 + -0.252269*X6147_4 + 0.317653*X6149_6 + 0.187455*X6160_2 + -0.200566*X6160_3 + -0.244828*X6160_4 + -0.137129*X6160_5 + -0.211081*X6162_2 + -0.221798*X6162_3 + -0.278686*X6162_4 + -0.175039*X6164_4 + -0.301365*X738 + 0.133794*X874 + -0.234943*X924 + -0.149257*X943
f11 =~ 0.359681*X135 + 0.629838*X20002_1387 + 0.374333*X20002_1452 + 0.813774*X20003_1140861998 + 0.529611*X20003_1140883504 + 0.191104*X20459 + 0.217204*X2178 + 0.306421*X2188 + 0.771156*X22126 + 0.960866*X22127 + 0.463769*X22129 + 0.588941*X22130 + 0.471917*X22502 + 0.486365*X22504 + -0.773655*X22616_0 + 0.735716*X22616_1 + 0.713246*X2316 + 0.333482*X2335 + 0.383916*X2492 + 0.214213*X30150 + -0.174284*X3063 + 0.193756*X4548 + 0.383908*X4717 + 0.62552*X6152_6 + 0.979508*X6152_8 + 0.781532*X6152_9
f12 =~ 0.227756*X102 + 0.489218*X135 + 0.492385*X20002_1473 + 0.593719*X20003_1140860696 + 0.580042*X20003_1140860806 + 0.51624*X20003_1140861958 + 0.361377*X20003_1140866738 + 0.351743*X20003_1140868226 + 0.628967*X20003_1140879778 + 0.677527*X20003_1140879802 + 0.511889*X20003_1140888560 + 0.451087*X20003_1141146234 + 0.560363*X20003_1141156836 + 0.700755*X20003_1141194794 + 0.148698*X20107_1 + 0.21474*X20107_8 + 0.214732*X20110_8 + 0.343736*X20111_8 + 0.216645*X20459 + 0.421338*X21001 + 0.283998*X2178 + 0.289387*X2188 + -0.180646*X23106 + 0.574553*X2443 + 0.219144*X2492 + 0.220647*X30000 + 0.122709*X30020 + -0.097902*X30180 + 0.104303*X30200 + 0.282376*X30240 + 0.281876*X30280 + 0.35582*X4079 + 0.305836*X4080 + 0.195883*X4194 + 0.26936*X4548 + 0.366033*X48 + 0.325517*X49 + -0.093849*X50 + 0.988955*X6150_4
f13 =~ 0.570948*X20003_1140852976 + 0.563905*X20003_1140909674 + 0.429412*X20003_1140916682 + 0.875859*X20003_1141188442 + 0.725005*X20003_1187 + 0.589731*X20003_1193 + 0.949619*X6155_1 + 0.685681*X6155_2 + 0.645427*X6155_3 + 0.727495*X6155_4 + 0.834105*X6155_5 + 0.554796*X6155_6 + 0.580368*X6155_7 + 0.662366*X6179_1 + 0.72147*X6179_2 + 0.595275*X6179_3 + 0.693431*X6179_4 + 0.582132*X6179_5 + 0.692499*X6179_6
f14 =~ 0.163759*X1170 + -0.237992*X135 + -0.36178*X1538_1 + -0.580163*X20002_1465 + -0.683312*X20003_1140879616 + -0.532947*X20003_1140884488 + -0.74121*X20003_1140923346 + -0.324399*X20003_2038460150 + -0.30757*X20459 + -0.331261*X20519 + -0.293243*X2080 + -0.204128*X21001 + -0.356022*X2178 + -0.577321*X2188 + -0.378431*X2296 + -0.496018*X2473 + -0.360772*X2492 + -0.446013*X41202_M16 + -0.595614*X41202_M17 + -0.428815*X41202_M25 + -0.527437*X41202_M51 + -0.487347*X41202_M54 + -0.330071*X4548 + 0.127735*X47 + -0.413238*X4717 + -0.523764*X4728 + 0.237566*X6142_1 + -0.346499*X6145_1 + -0.406997*X6154_6 + -0.275858*X6159_3 + -0.321276*X6159_4 + -0.563778*X6159_6 + -0.456271*X6159_7 + 0.470807*X924
f15 =~ 0.114669*X1259 + 0.142677*X1349 + 0.197045*X1359 + -0.274514*X189 + -0.284825*X2020 + -0.226405*X20458 + 0.211846*X20460 + 0.315011*X20522 + 0.279815*X2110 + -0.22162*X2149 + -0.324545*X2159 + -0.250359*X4526 + -0.199608*X4559 + -0.217651*X4581 + 0.226192*X6139_1 + 0.198949*X6139_2 + 0.721181*X6140_1 + -0.896149*X6140_2 + 0.791362*X6141_1 + 0.482711*X6141_2 + 0.253596*X6142_3 + -0.374047*X6145_5 + 0.384698*X6162_1 + -0.224539*X6162_3 + 0.1544*X6164_4 + 0.77854*X670_1 + 0.108093*X699 + 0.610971*X728 + 0.472463*X738 + 0.301439*X943
f16 =~ -0.187762*X102 + 0.324271*X135 + 0.385982*X1538_1 + 0.415085*X20002_1473 + 0.41511*X20003_1140860806 + 0.45018*X20003_1140861958 + 0.55756*X20003_1140866738 + 0.624602*X20003_1140868226 + 0.788866*X20003_1140879760 + 0.546754*X20003_1141146234 + 0.268886*X20111_1 + 0.323061*X20528 + 0.305426*X2178 + 0.316733*X2188 + 0.411585*X2335 + 0.322218*X2473 + 0.277443*X2492 + -0.225717*X4079 + -0.176238*X4080 + 0.784112*X41202_I20 + 0.841619*X41202_I21 + 0.845866*X41202_I25 + 0.452165*X41202_I48 + 0.469893*X41202_R07 + 0.673306*X41248_5001 + -0.184372*X4194 + 0.255525*X4548 + 0.323517*X4717 + 0.2892*X6145_1 + 0.982242*X6150_1 + 0.929851*X6150_2
f17 =~ 0.114373*X20016 + -0.046932*X22501 + 0.72083*X22599 + 0.685941*X22606_0 + 0.650742*X22607_0 + 0.64505*X22608_0 + 0.662899*X22609_0 + 0.617141*X22610_0 + 0.44969*X22611_0 + 0.203806*X22611_1 + 0.567386*X22613_0 + 0.574102*X22615_0 + 0.37172*X22616_0 + 0.326173*X22617_1132 + 0.305986*X22617_2132 + -0.191207*X22617_2314 + -0.210845*X22617_2315 + 0.313592*X22617_3539 + 0.26046*X22617_4112 + 0.255758*X22617_4113 + 0.264955*X22617_4122 + 0.244077*X22617_4123 + 0.308613*X22617_4150 + 0.256102*X22617_4215 + 0.312016*X22617_7111 + 0.310711*X22617_9219 + 0.558106*X22620_0 + -0.206006*X4825
f18 =~ 0.227245*X1200 + 0.215119*X135 + 0.590234*X20002_1265 + 0.243534*X20002_1465 + 0.173675*X20003_1140868226 + 0.644329*X20003_1140871310 + 0.465813*X20003_1140879406 + 0.604927*X20003_2038460150 + 0.159006*X2080 + 0.162566*X2178 + 0.145165*X2492 + 0.149867*X4548 + 0.235198*X4728 + 0.188937*X6149_1 + 0.602542*X6159_1 + 0.629675*X6159_2 + 0.333289*X6159_3 + 0.296336*X6159_4 + 0.308017*X6159_5 + 0.3555*X6159_6 + 0.332493*X6159_7
f19 =~ 0.397564*X2463 + 0.097339*X4100 + -0.802433*X4101 + -0.850748*X4105 + 0.095701*X4119 + -0.78777*X4120 + -0.837165*X4124 + 0.680592*X6151_5
f2 =~ 0.100884*X1031 + -0.176522*X1160 + -0.416688*X1170 + 0.174258*X1180 + 0.240942*X1190 + 0.312033*X1200 + 0.296922*X1220 + 0.128473*X1737 + 0.667702*X1920 + 0.635579*X1930 + 0.540499*X1940 + 0.423931*X1950 + 0.738021*X1960 + 0.452691*X1970 + 0.449483*X1980 + 0.505892*X1990 + 0.404898*X2000 + 0.388643*X20002_1286 + 0.439749*X2010 + 0.591521*X2020 + 0.470034*X2030 + 0.262596*X20421 + 0.394951*X20425 + 0.323965*X20441 + 0.277055*X20446 + 0.496476*X20458 + 0.352269*X20459 + -0.408547*X20460 + 0.392152*X20479 + 0.314212*X20485 + -0.222414*X20489 + 0.212757*X20495 + 0.188923*X20497 + 0.185953*X20498 + 0.284379*X20499 + 0.739356*X2050 + 0.281941*X20500 + 0.32313*X20502 + 0.387593*X20505 + 0.294667*X20506 + 0.426805*X20507 + 0.403484*X20508 + 0.305435*X20509 + 0.439753*X20510 + 0.372372*X20511 + 0.298436*X20512 + 0.47198*X20513 + 0.464755*X20514 + 0.301199*X20515 + 0.316628*X20517 + 0.376779*X20519 + 0.297095*X20520 + -0.194406*X20522 + 0.354569*X20544_11 + 0.25129*X20544_15 + 0.727887*X2060 + 0.591405*X2070 + 0.501789*X2080 + 0.430936*X2090 + 0.351313*X2100 + -0.346707*X2110 + 0.416357*X2178 + 0.229165*X2247_1 + 0.296383*X2257 + 0.326642*X2335 + 0.730054*X4526 + 0.515391*X4537 + 0.454645*X4548 + 0.454498*X4559 + 0.467109*X4570 + 0.399036*X4581 + 0.371176*X4598 + 0.377646*X4631 + 0.427942*X4653 + 0.439444*X4717 + 0.304734*X4728 + -0.225716*X4803_0 + 0.420724*X6145_6 + 0.209231*X6149_1 + 0.250546*X6149_3 + 0.360043*X6159_1 + 0.306199*X6159_3 + 0.278044*X6159_4 + 0.384719*X6159_5
f20 =~ 0.234312*X135 + 0.473768*X136 + 0.395343*X1538_1 + 0.442895*X20003_1140864752 + 0.302657*X20459 + 0.186661*X20519 + 0.605743*X20528 + 0.184453*X2080 + 0.328661*X2178 + 0.366033*X2188 + 0.306543*X2345 + 0.629313*X2453 + 0.188542*X2463 + 0.427115*X2473 + 0.234561*X2492 + 0.248152*X41202_C44 + 0.471036*X41202_D12 + 0.377205*X41202_K29 + 0.490765*X41202_K52 + 0.462319*X41202_K57 + 0.459015*X41202_K62 + 0.461739*X41202_K63 + 0.322646*X41202_M54 + 0.379906*X41202_R07 + 0.439776*X41202_R10 + 0.464569*X41202_T81 + 0.532049*X41202_Z09 + 0.485389*X41215_0 + 0.745288*X41231_1 + 0.31613*X4548 + 0.147847*X4728 + 0.476163*X6145_1 + 0.124962*X6159_4 + 0.334547*X6159_5
f21 =~ 0.555094*X1697 + 0.437672*X20015 + -0.12712*X30000 + -0.109526*X30080 + 0.527946*X3062 + 0.539996*X3063 + 0.395161*X3064 + 0.260285*X4100 + 0.267438*X4119 + 0.246164*X46 + 0.25141*X47 + 0.196674*X49 + 0.485348*X50 + -0.228978*X5132 + -0.227392*X5135 + 0.132149*X924
f22 =~ 0.238425*X1100 + 0.146849*X1110 + 0.082434*X1339 + 0.107934*X1349 + 0.088547*X1359 + -0.220012*X1458 + 0.161349*X1478 + 0.136095*X1498 + -0.831947*X1558 + 0.182331*X1568 + 0.247065*X1578 + 0.30367*X1588 + 0.137773*X1598 + -0.273508*X1628 + 0.249909*X20160 + 0.177414*X20401 + 0.665313*X20403 + -0.565029*X20405_0 + -0.277625*X20411_0 + 0.836636*X20414 + 0.759577*X20416 + 0.242046*X20453 + -0.18012*X2139 + 0.253007*X2149 + 0.221325*X22506_113 + 0.213041*X30040 + -0.129892*X4674 + -0.037035*X6141_2 + 0.133148*X6160_1 + 0.438181*X6160_2 + -0.285945*X6160_3 + 0.138588*X738
f23 =~ 0.179819*X102 + 0.107019*X1031 + -0.399845*X1050 + -0.492071*X1060 + -0.231494*X1170 + 0.186374*X1180 + -0.146332*X1289 + -0.199226*X1299 + -0.17088*X1309 + -0.16521*X1319 + -0.142816*X1329 + -0.090392*X1339 + -0.140301*X1528 + 0.122282*X1727 + -0.133799*X2040 + 0.18927*X20459 + 0.219984*X2080 + 0.286031*X2178 + 0.162986*X2306 + -0.051558*X2463 + 0.16906*X4194 + 0.119699*X4526 + 0.268391*X4548 + 0.07723*X4570 + 0.321604*X4717 + 0.206133*X48 + 0.194103*X49 + 0.171216*X6142_1 + -0.221347*X6142_2 + -0.51666*X6160_1 + -0.081572*X6160_2 + -0.103456*X6160_5 + -0.263856*X6162_2 + -0.451548*X6162_4 + -0.556412*X6164_2 + -0.560732*X6164_3 + -0.260733*X6164_5 + -0.596289*X864 + -0.393414*X874 + -0.633571*X884 + -0.451332*X894 + -0.66701*X904 + -0.306912*X924 + -0.235615*X943 + -0.308581*X971 + -0.192272*X981
f24 =~ 0.063341*X2217 + -0.159065*X5084 + -0.156775*X5085 + -0.349365*X5086 + -0.338169*X5087 + 0.375651*X5116 + 0.379037*X5119 + -0.078798*X5132 + -0.08332*X5135 + -0.535381*X5156 + -0.493579*X5159 + -0.417436*X5160 + -0.419378*X5163 + -0.188797*X5201 + -0.197868*X5208 + 0.039671*X6147_3 + -0.177498*X6147_4
f25 =~ 0.22753*X135 + 0.709249*X20002_1277 + 0.932387*X20002_1278 + 0.860397*X2227 + 0.588301*X41202_H25 + 0.699713*X41202_H26 + -0.120839*X5132 + -0.116757*X5135 + 0.601762*X5181 + 0.239871*X5201 + 0.233817*X5208 + 0.399786*X6148_5 + 0.69967*X6148_6
f26 =~ 0.123755*X102 + 0.238044*X20002_1277 + 0.19578*X4079 + 0.202294*X4080 + 0.108972*X4194 + 0.562977*X5254 + 0.701834*X5255 + 0.498475*X5257 + 0.555836*X5262 + 0.714684*X5263 + 0.531802*X5265
f27 =~ 0.516629*X2217 + 0.706994*X5084 + 0.636006*X5085 + -0.489762*X5086 + -0.487913*X5087 + 0.458015*X5116 + 0.46747*X5119 + -0.291308*X5132 + -0.298744*X5135 + -0.751897*X6147_1 + 0.270997*X6147_2 + 0.414869*X6147_3 + -0.460684*X6147_4
f28 =~ 0.112328*X102 + 0.514691*X1538_1 + 0.52091*X20002_1473 + 0.586233*X20003_1140861958 + 0.171948*X20003_1140868226 + 0.324503*X20111_9 + 0.188338*X2188 + 0.804893*X2443 + 0.199589*X2492 + -0.096701*X4079 + 0.305422*X6144_4
f29 =~ 0.066731*X102 + -0.259139*X1100 + -0.431394*X1110 + -0.525984*X1120 + -0.451946*X1130 + 0.156811*X1160 + 0.049535*X1349 + -0.124731*X1428_1 + 0.117006*X1438 + 0.126673*X1458 + 0.137162*X1757 + 0.331547*X1970 + 0.210184*X1980 + 0.182002*X2000 + 0.068734*X20077 + 0.22087*X2010 + -0.313096*X2040 + -0.185233*X20521 + -0.185667*X20523 + 0.248183*X2139 + -0.314809*X2149 + 0.103802*X23106 + -0.228171*X4581 + -0.149422*X6141_2 + -0.887266*X6142_1 + 0.94745*X6142_2 + 0.398652*X6142_3 + 0.226628*X6142_6 + -0.333267*X6145_5 + -0.371455*X6145_6 + 0.173276*X6160_3 + 0.197733*X6162_2 + 0.133742*X6162_3 + 0.412385*X680_1 + 0.164759*X699 + -0.169491*X728 + -0.23198*X738
f3 =~ 0.325978*X135 + 0.248288*X1920 + 0.254541*X1930 + 0.227771*X1950 + 0.148621*X1960 + 0.274116*X1970 + 0.259043*X1980 + 0.296624*X1990 + 0.176568*X2000 + 0.689649*X20002_1286 + 0.746448*X20002_1287 + 0.892984*X20003_1140921600 + 0.314217*X2010 + 0.281871*X20111_12 + 0.153705*X2020 + 0.226502*X2030 + 0.534575*X20421 + 0.512409*X20425 + 0.629903*X20441 + 0.684681*X20446 + 0.340413*X20479 + 0.509626*X20480 + 0.392665*X20485 + 0.228015*X20495 + 0.212862*X20497 + 0.222759*X20498 + 0.7893*X20499 + 0.181365*X2050 + 0.723344*X20500 + 0.359232*X20501 + 0.185464*X20502 + 0.203809*X20506 + 0.124238*X20507 + 0.240504*X20509 + 0.064983*X20510 + 0.246969*X20512 + 0.20012*X20515 + 0.206683*X20520 + 0.211547*X20521 + 0.497363*X20544_1 + 0.729804*X20544_11 + 0.64952*X20544_15 + 0.509288*X20544_6 + 0.136178*X2060 + 0.222358*X2070 + 0.152465*X2080 + 0.854869*X2090 + 0.666687*X2100 + 0.377629*X2492 + 0.771571*X4598 + 0.657266*X4631 + 0.421349*X4642 + 0.229715*X4653
f30 =~ 0.234608*X102 + 0.154192*X1259 + -0.177874*X1289 + -0.226714*X1299 + -0.303867*X1309 + -0.244736*X1319 + -0.286329*X1329 + -0.200567*X1339 + 0.200055*X1349 + 0.110116*X1408 + 0.280693*X1418_1 + -0.179057*X1418_3 + -0.307883*X1418_4 + 0.167658*X1428_1 + 0.120289*X1438 + 0.378572*X1448_1 + -0.211043*X1458 + -0.165975*X1468_3 + 0.179783*X1478 + -0.192798*X1508_1 + 0.219429*X1508_2 + -0.234683*X1528 + -0.089976*X1538_2 + 0.200089*X20458 + -0.224256*X2267 + 0.430569*X30000 + 0.320844*X30080 + -0.185527*X30100 + -0.287486*X30180 + 0.341499*X30200 + 0.297611*X30510 + 0.202825*X30520 + 0.286607*X30530 + 0.22966*X4194 + 0.23023*X4526 + 0.239937*X4559 + 0.227952*X4570 + 0.164404*X4581 + 0.159392*X4674 + 0.063208*X6141_2 + -0.200409*X6144_4 + -0.156532*X6155_7 + -0.372293*X6160_1 + -0.393073*X6164_2 + -0.215556*X6179_1 + -0.205215*X904
f31 =~ 0.288075*X135 + 0.804657*X20002_1138 + 0.765524*X20002_1474 + 0.69132*X20003_1140864752 + 0.885137*X20003_1140865634 + 0.187839*X2188 + -0.107793*X2453 + 0.533381*X2492 + 0.534893*X41202_K20 + 0.589158*X41202_K21 + 0.574993*X41202_K22 + 0.35296*X41202_K29 + 0.38245*X41202_K30 + 0.609897*X41202_K44 + 0.260353*X41202_R10 + 0.334743*X41231_1 + 0.319537*X6159_5
f32 =~ 0.605488*X20019 + 0.605621*X20021 + 0.609774*X2247_1 + 0.549739*X2257 + 0.565968*X3393 + 0.605284*X4230 + 0.628692*X4241 + 0.480972*X4270 + 0.483215*X4277 + -0.387109*X4803_0 + 0.532837*X4803_11
f33 =~ 0.059745*X1100 + 0.130534*X1110 + -0.292812*X129 + 0.323926*X130 + 0.109481*X1329 + -0.030157*X1349 + 0.001567*X1359 + 0.113831*X1428_1 + -0.094733*X1438 + -0.545187*X1508_2 + 0.634642*X1508_3 + -0.12476*X1558 + 0.074289*X1568 + 0.185802*X1578 + -0.115001*X1588 + 0.541494*X20074 + -0.029774*X20118_5 + 0.131936*X20118_7 + 0.126239*X20414 + 0.232894*X22617_1112 + 0.538817*X22702 + -0.484757*X22704 + -0.134891*X24006 + 0.253366*X24016 + 0.389841*X24019 + -0.23343*X4674 + -0.005173*X6139_1 + -0.255693*X6139_2 + 0.173499*X6139_3 + -0.158374*X6140_1 + 0.159095*X6140_2 + 0.072798*X6141_1 + 0.051997*X6141_2 + -0.133428*X6160_2 + -0.222235*X670_1 + 0.035391*X728 + 0.281675*X738
f34 =~ 0.132493*X1080 + 0.162783*X1100 + -0.121254*X1970 + 0.408041*X20016 + -0.145327*X20019 + -0.305316*X20023 + 0.081838*X20077 + 0.421776*X20128 + 0.165399*X20491 + 0.106425*X20522 + 0.168589*X20525 + 0.22034*X2237 + 0.022468*X22501 + -0.004063*X22607_1 + 0.396913*X22617_1136 + 0.457811*X22617_2131 + 0.461193*X22617_2132 + 0.07504*X3063 + 0.106585*X3064 + -0.619024*X399 + -0.566657*X400 + -0.319883*X404 + -0.157871*X4230 + -0.48747*X4290 + -0.970204*X4291 + 0.674038*X4294_1 + 0.199873*X6138_2 + 0.180625*X6138_3 + 0.064271*X6142_2 + 0.089583*X6145_2 + 0.109767*X6162_1 + -0.084553*X864
f35 =~ 0.12178*X102 + 0.201766*X1970 + 0.131994*X1980 + 0.163037*X1990 + -0.01592*X20003_1140852976 + -0.008969*X20003_1140909674 + -0.058394*X20003_1141188442 + -0.03751*X20003_1187 + -0.019899*X20003_1193 + 0.16108*X2010 + 0.047741*X20425 + -0.129542*X20458 + 0.069214*X20460 + 0.017718*X20489 + -0.001073*X20514 + 0.050617*X2110 + -0.777289*X30180 + 0.80287*X30200 + -0.046691*X30510 + 0.118607*X4194 + -0.175639*X4526 + -0.071065*X4537 + -0.226938*X4559 + -0.235577*X4570 + 0.02061*X6155_7 + 0.076625*X6160_1 + 0.074837*X6164_2 + 0.032502*X6179_1 + -0.040304*X6179_2
f36 =~ 0.945948*X1150_1 + -0.986445*X1150_2 + -0.30723*X1707_1
f4 =~ 0.116945*X129 + -0.108481*X130 + -0.462412*X189 + -0.390979*X20074 + -0.973506*X20118_5 + 0.876289*X20118_6 + 0.944581*X20118_7 + -0.210455*X20453 + -0.16411*X2149 + -0.385626*X22702 + 0.314559*X22704 + -0.912749*X24003 + -0.838137*X24004 + -0.619299*X24005 + -0.808011*X24006 + -0.314819*X24008 + -0.168131*X24011 + -0.492063*X24013 + -0.832766*X24016 + -0.707191*X24019 + -0.33384*X24024 + -0.153421*X6139_1 + 0.22235*X6139_3 + -0.233143*X6140_1 + 0.221178*X6141_1 + -0.167433*X6147_1 + 0.394856*X6162_1 + -0.154079*X6162_2 + -0.377607*X6162_3 + 0.18825*X6164_5 + 0.398598*X670_1 + 0.335864*X728
f5 =~ 0.216194*X1050 + 0.266299*X1279 + -0.156153*X1578 + -0.218632*X20016 + 0.257336*X20488 + 0.214896*X20502 + 0.384509*X20527 + 0.215254*X20530 + -0.184091*X2139 + -0.140491*X22501 + 0.259529*X22502 + 0.293*X22504 + 0.299412*X22599 + -0.313713*X22606_0 + 0.446856*X22606_1 + 0.746466*X22606_2 + -0.344852*X22607_0 + 0.617181*X22607_1 + 0.677391*X22607_2 + -0.294524*X22608_0 + 0.589302*X22608_1 + 0.61409*X22608_2 + -0.401999*X22609_0 + 0.594392*X22609_1 + 0.722923*X22609_2 + -0.353877*X22610_0 + 0.591185*X22610_1 + 0.654407*X22610_2 + 0.278414*X22611_1 + 0.466884*X22611_2 + -0.3228*X22613_0 + 0.552527*X22613_1 + 0.567835*X22613_2 + 0.419475*X22614_1 + -0.379853*X22615_0 + 0.616021*X22615_1 + 0.662871*X22615_2 + 0.351124*X22616_1 + 0.578535*X22617_3311 + 0.286603*X22617_7111 + 0.496935*X22617_8139 + 0.429932*X22617_9139 + 0.423635*X22617_9149 + 0.470312*X22620_1 + 0.223714*X4581 + 0.175978*X4674 + -0.202282*X4803_0 + 0.660027*X4825 + 0.143645*X5084 + -0.38713*X6138_1 + -0.252366*X6138_2 + 0.278118*X6138_5 + -0.219558*X6147_1 + -0.175204*X6160_1 + -0.320519*X738 + 0.162953*X874 + 0.101148*X884 + 0.187626*X894
f6 =~ 0.943618*X20160 + 0.242732*X20401 + 0.077352*X20416 + 0.513012*X20453 + -0.29233*X2139 + 0.378466*X2149 + 0.909526*X22506_113
f7 =~ 0.167713*X102 + 0.224675*X1070 + 0.127821*X1080 + -0.290997*X1210 + 0.158793*X1349 + 0.140789*X1359 + 0.177823*X1548 + 0.223444*X1687 + 0.143257*X1697 + -0.099122*X1970 + 0.101484*X20015 + 0.164095*X20459 + 0.315196*X20511 + 0.704697*X21001 + 0.534962*X21021 + 0.232569*X2178 + 0.255037*X2237 + 0.159676*X2306 + -0.363791*X23106 + 0.273809*X2316 + 0.173967*X30000 + -0.120908*X30040 + 0.178823*X30150 + 0.303778*X30240 + 0.296807*X30280 + 0.268559*X30510 + 0.172423*X30520 + 0.237047*X30530 + -0.209521*X3062 + -0.179809*X3063 + 0.200818*X4079 + 0.090314*X4080 + 0.552536*X4100 + 0.140546*X4101 + 0.557929*X4119 + 0.131804*X4120 + 0.148602*X4194 + -0.511859*X4196 + 0.224645*X4548 + 0.417449*X4717 + 0.272392*X4728 + 0.583701*X48 + 0.669989*X49 + 0.082767*X50 + 0.224411*X6159_7 + -0.334044*X924
f9 =~ 0.164325*X1558 + 0.169391*X1787 + 0.190213*X189 + 0.246*X20002_1286 + 0.358311*X20110_12 + 0.296874*X20111_12 + 0.20661*X2020 + 0.192432*X2040 + 0.631091*X20401 + -0.386928*X20405_0 + -0.419807*X20411_0 + -0.169978*X20414 + 0.239112*X20421 + 0.387736*X20441 + 0.358677*X20446 + 0.305484*X20453 + 0.238963*X20458 + 0.248173*X20459 + -0.220167*X20460 + 0.608128*X20463 + 0.527826*X20471 + 0.467537*X20479 + 0.628571*X20480 + 0.532868*X20485 + 0.607642*X20487 + 0.531374*X20488 + -0.430893*X20489 + 0.577068*X20490 + -0.389704*X20491 + 0.39187*X20495 + 0.432355*X20497 + 0.423591*X20498 + 0.319246*X20499 + 0.190275*X2050 + 0.358464*X20500 + 0.441002*X20501 + 0.27045*X20502 + 0.311605*X20507 + 0.331916*X20508 + 0.322675*X20510 + 0.352942*X20511 + 0.473082*X20513 + 0.346315*X20514 + 0.292081*X20516 + 0.208628*X20517 + 0.455075*X20518 + 0.289164*X20519 + 0.493432*X20521 + -0.193759*X20522 + 0.589751*X20523 + -0.372219*X20525 + 0.343119*X20526 + 0.305412*X20529 + 0.266424*X20530 + 0.591254*X20531 + 0.309847*X20544_1 + 0.325837*X20544_11 + 0.219606*X20544_6 + 0.679454*X20552_2 + 0.208436*X2060 + 0.324817*X2100 + -0.135476*X2139 + 0.291552*X2149 + 0.340266*X2159 + 0.194658*X2247_1 + 0.223665*X2257 + 0.201135*X22620_1 + 0.295856*X2296 + 0.237899*X2335 + 0.238634*X4559 + 0.166421*X4570 + 0.219039*X4581 + 0.289065*X4631 + 0.48012*X4642 + 0.291931*X4653 + -0.171084*X4803_0 + 0.340525*X4836 + 0.368262*X6145_6
X1200 + X1920 + X1930 + X1940 + X1950 + X1960 + X1970 + X1980 + X1990 + X2000 + X20002_1286 + X2010 + X2020 + X2030 + X20421 + X20425 + X20441 + X20446 + X20458 + X20459 + X20460 + X20479 + X20485 + X20487 + X20489 + X20495 + X20497 + X20498 + X20499 + X2050 + X20500 + X20501 + X20502 + X20505 + X20506 + X20507 + X20508 + X20509 + X20510 + X20511 + X20512 + X20513 + X20514 + X20515 + X20516 + X20517 + X20518 + X20519 + X20520 + X20521 + X20544_1 + X20544_11 + X20544_15 + X20544_6 + X2060 + X2070 + X2080 + X2178 + X4526 + X4548 + X1050 + X1070 + X1080 + X1299 + X1309 + X1319 + X1349 + X1359 + X1408 + X1428_1 + X1448_1 + X1468_2 + X1468_4 + X1508_2 + X1508_3 + X1558 + X1568 + X1578 + X1588 + X1737 + X1787 + X20016 + X20077 + X20128 + X20414 + X20453 + X20491 + X20522 + X20525 + X21001 + X2139 + X22501 + X22599 + X22607_0 + X22607_1 + X22608_0 + X22611_0 + X22615_0 + X22617_2311 + X22617_2312 + X22617_2313 + X22617_2314 + X22617_2315 + X22617_2319 + X22617_2329 + X22617_4150 + X22617_7111 + X22617_9219 + X22704 + X24016 + X30530 + X4290 + X4570 + X50 + X5057 + X5084 + X5085 + X6138_1 + X6138_2 + X6138_3 + X6138_4 + X6138_5 + X6138_6 + X6139_3 + X6147_4 + X6149_6 + X6160_2 + X6160_3 + X6160_4 + X6160_5 + X6162_2 + X6162_3 + X6162_4 + X6164_4 + X738 + X874 + X924 + X943 + X135 + X20002_1387 + X20002_1452 + X20003_1140861998 + X20003_1140883504 + X2188 + X22126 + X22127 + X22129 + X22130 + X22502 + X22504 + X22616_0 + X22616_1 + X2316 + X2335 + X2492 + X30150 + X3063 + X4717 + X6152_6 + X6152_8 + X6152_9 + X102 + X20002_1473 + X20003_1140860696 + X20003_1140860806 + X20003_1140861958 + X20003_1140866738 + X20003_1140868226 + X20003_1140879778 + X20003_1140879802 + X20003_1140888560 + X20003_1141146234 + X20003_1141156836 + X20003_1141194794 + X20107_1 + X20107_8 + X20110_8 + X20111_8 + X23106 + X2443 + X30000 + X30020 + X30180 + X30200 + X30240 + X30280 + X4079 + X4080 + X4194 + X48 + X49 + X6150_4 + X20003_1140852976 + X20003_1140909674 + X20003_1140916682 + X20003_1141188442 + X20003_1187 + X20003_1193 + X6155_1 + X6155_2 + X6155_3 + X6155_4 + X6155_5 + X6155_6 + X6155_7 + X6179_1 + X6179_2 + X6179_3 + X6179_4 + X6179_5 + X6179_6 + X1170 + X1538_1 + X20002_1465 + X20003_1140879616 + X20003_1140884488 + X20003_1140923346 + X20003_2038460150 + X2296 + X2473 + X41202_M16 + X41202_M17 + X41202_M25 + X41202_M51 + X41202_M54 + X47 + X4728 + X6142_1 + X6145_1 + X6154_6 + X6159_3 + X6159_4 + X6159_6 + X6159_7 + X1259 + X189 + X2110 + X2149 + X2159 + X4559 + X4581 + X6139_1 + X6139_2 + X6140_1 + X6140_2 + X6141_1 + X6141_2 + X6142_3 + X6145_5 + X6162_1 + X670_1 + X699 + X728 + X20003_1140879760 + X20111_1 + X20528 + X41202_I20 + X41202_I21 + X41202_I25 + X41202_I48 + X41202_R07 + X41248_5001 + X6150_1 + X6150_2 + X22606_0 + X22609_0 + X22610_0 + X22611_1 + X22613_0 + X22617_1132 + X22617_2132 + X22617_3539 + X22617_4112 + X22617_4113 + X22617_4122 + X22617_4123 + X22617_4215 + X22620_0 + X4825 + X20002_1265 + X20003_1140871310 + X20003_1140879406 + X6149_1 + X6159_1 + X6159_2 + X6159_5 + X2463 + X4100 + X4101 + X4105 + X4119 + X4120 + X4124 + X6151_5 + X1031 + X1160 + X1180 + X1190 + X1220 + X2090 + X2100 + X2247_1 + X2257 + X4537 + X4598 + X4631 + X4653 + X4803_0 + X6145_6 + X6149_3 + X136 + X20003_1140864752 + X2345 + X2453 + X41202_C44 + X41202_D12 + X41202_K29 + X41202_K52 + X41202_K57 + X41202_K62 + X41202_K63 + X41202_R10 + X41202_T81 + X41202_Z09 + X41215_0 + X41231_1 + X1697 + X20015 + X30080 + X3062 + X3064 + X46 + X5132 + X5135 + X1100 + X1110 + X1339 + X1458 + X1478 + X1498 + X1598 + X1628 + X20160 + X20401 + X20403 + X20405_0 + X20411_0 + X20416 + X22506_113 + X30040 + X4674 + X6160_1 + X1060 + X1289 + X1329 + X1528 + X1727 + X2040 + X2306 + X6142_2 + X6164_2 + X6164_3 + X6164_5 + X864 + X884 + X894 + X904 + X971 + X981 + X2217 + X5086 + X5087 + X5116 + X5119 + X5156 + X5159 + X5160 + X5163 + X5201 + X5208 + X6147_3 + X20002_1277 + X20002_1278 + X2227 + X41202_H25 + X41202_H26 + X5181 + X6148_5 + X6148_6 + X5254 + X5255 + X5257 + X5262 + X5263 + X5265 + X6147_1 + X6147_2 + X20111_9 + X6144_4 + X1120 + X1130 + X1438 + X1757 + X20523 + X6142_6 + X680_1 + X20002_1287 + X20003_1140921600 + X20111_12 + X20480 + X4642 + X1418_1 + X1418_3 + X1418_4 + X1468_3 + X1508_1 + X1538_2 + X2267 + X30100 + X30510 + X30520 + X20002_1138 + X20002_1474 + X20003_1140865634 + X41202_K20 + X41202_K21 + X41202_K22 + X41202_K30 + X41202_K44 + X20019 + X20021 + X3393 + X4230 + X4241 + X4270 + X4277 + X4803_11 + X129 + X130 + X20074 + X20118_5 + X20118_7 + X22617_1112 + X22702 + X24006 + X24019 + X20023 + X2237 + X22617_1136 + X22617_2131 + X399 + X400 + X404 + X4291 + X4294_1 + X6145_2 + X1150_1 + X1150_2 + X1707_1 + X20118_6 + X24003 + X24004 + X24005 + X24008 + X24011 + X24013 + X24024 + X1279 + X20488 + X20527 + X20530 + X22606_1 + X22606_2 + X22607_2 + X22608_1 + X22608_2 + X22609_1 + X22609_2 + X22610_1 + X22610_2 + X22611_2 + X22613_1 + X22613_2 + X22614_1 + X22615_1 + X22615_2 + X22617_3311 + X22617_8139 + X22617_9139 + X22617_9149 + X22620_1 + X1210 + X1548 + X1687 + X21021 + X4196 + X20110_12 + X20463 + X20471 + X20490 + X20526 + X20529 + X20531 + X20552_2 + X4836 ~ PC1 + PC10 + PC11 + PC12 + PC13 + PC14 + PC15 + PC16 + PC17 + PC18 + PC19 + PC2 + PC20 + PC3 + PC4 + PC5 + PC6 + PC7 + PC8 + PC9 + age + age_isFemale + age_squared + age_squared_isFemale + isFemale"

training$isFemale = as.numeric(training$isFemale)

fit = cfa(model,data=training,std.ov=TRUE,std.lv=TRUE,conditional.x=TRUE,fixed.x=TRUE,orthogonal=TRUE,estimator="DWLS",se="robust",test="scaled.shifted",control=list(iter.max=10000),optim.force.converged=TRUE)

#fit = cfa(model,data=training,std.ov=TRUE,std.lv=TRUE,conditional.x=TRUE,fixed.x=TRUE,orthogonal=TRUE,estimator="DWLS",se="standard",control=list(iter.max=10000),optim.force.converged=TRUE)

saveRDS(fit,"fit_full.Rds")

warnings()
summary(fit)
#fitmeasures(fit, fit.measures="all")
warnings()
